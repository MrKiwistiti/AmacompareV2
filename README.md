# üõí AmaCompare

**Comparateur de prix Amazon intelligent pour l'Europe** üá™üá∫

AmaCompare est une solution compl√®te de comparaison et surveillance des prix Amazon √† travers 4 pays europ√©ens (France, Allemagne, Italie, Espagne). L'application offre une recherche dynamique, un suivi historique des prix, et un syst√®me d'alertes par email.

![AmaCompare Banner](https://via.placeholder.com/800x200/667eea/ffffff?text=AmaCompare+-+Smart+Amazon+Price+Tracker)

## ‚ú® Fonctionnalit√©s Principales

### üîç **Recherche Dynamique**
- Recherche instantan√©e de produits sur Amazon.fr
- Extraction automatique des ASIN, prix, images et √©valuations
- Interface moderne avec mode sombre/clair

### üí∞ **Comparaison Multi-Pays**
- Comparaison simultan√©e des prix sur 4 sites Amazon europ√©ens
- Identification automatique du meilleur prix et calcul des √©conomies
- Affichage des disponibilit√©s et frais de livraison

### üìà **Historique des Prix**
- Stockage automatique de l'historique des prix dans une base SQLite
- Graphiques interactifs (courbes et aires) avec Recharts
- Statistiques avanc√©es (min, max, moyenne, tendances)

### üîî **Alertes Prix Intelligentes**
- Syst√®me d'alertes par email configurables par pays
- Notifications automatiques quand le prix passe sous le seuil d√©fini
- Templates d'emails HTML responsives avec d√©tails du produit

### ‚ö° **Performance & Fiabilit√©**
- Cache intelligent avec gestion TTL
- Rate limiting pour √©viter la surcharge
- Gestion d'erreurs robuste avec retry automatique
- Logs d√©taill√©s pour monitoring

## üèóÔ∏è Architecture Technique

### Backend (Node.js/Express)
```
‚îú‚îÄ‚îÄ üìÅ src/
‚îÇ   ‚îî‚îÄ‚îÄ server.js          # Serveur principal avec toutes les routes
‚îú‚îÄ‚îÄ üìÅ data/
‚îÇ   ‚îî‚îÄ‚îÄ price_history.db   # Base SQLite (auto-cr√©√©e)
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ .env                   # Configuration
‚îî‚îÄ‚îÄ README.md
```

### Frontend (React)
```
‚îú‚îÄ‚îÄ üìÅ src/
‚îÇ   ‚îú‚îÄ‚îÄ App.js                    # Composant principal
‚îÇ   ‚îú‚îÄ‚îÄ index.js                  # Point d'entr√©e
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ contexts/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ThemeContext.js       # Gestion th√®me sombre/clair
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ components/
‚îÇ       ‚îú‚îÄ‚îÄ ThemeToggle.js        # Bouton changement th√®me
‚îÇ       ‚îú‚îÄ‚îÄ PriceHistory.js       # Graphiques historique
‚îÇ       ‚îî‚îÄ‚îÄ PriceAlerts.js        # Gestion alertes
‚îî‚îÄ‚îÄ public/
```

### Technologies Utilis√©es

**Backend:**
- **Express.js** - Framework web rapide
- **Puppeteer** - Web scraping Amazon avec navigateur headless
- **better-sqlite3** - Base de donn√©es l√©g√®re et performante
- **Nodemailer** - Envoi d'emails avec templates HTML
- **node-cache** - Cache m√©moire avec TTL
- **express-rate-limit** - Protection contre le spam

**Frontend:**
- **React** - Interface utilisateur moderne
- **Recharts** - Graphiques interactifs pour l'historique
- **Context API** - Gestion d'√©tat globale (th√®mes)
- **CSS-in-JS** - Styling avec support th√®me

## üöÄ Installation & Configuration

### Pr√©requis
- **Node.js** ‚â• 16.0.0
- **npm** ‚â• 8.0.0
- **Chrome/Chromium** (pour Puppeteer)

### 1. Cloner le Projet
```bash
git clone https://github.com/votre-repo/amacompare.git
cd amacompare
```

### 2. Installation Backend
```bash
cd backend
npm install
```

### 3. Configuration des Variables d'Environnement

Cr√©ez un fichier `.env` dans le dossier backend :

```env
# ========== CONFIGURATION SERVEUR ==========
PORT=5000
NODE_ENV=development

# ========== CONFIGURATION CACHE ==========
CACHE_DURATION=3600

# ========== CONFIGURATION REQU√äTES ==========
REQUEST_TIMEOUT=15000

# ========== CONFIGURATION PUPPETEER ==========
PUPPETEER_EXECUTABLE_PATH=""

# ========== CONFIGURATION CORS ==========
ALLOWED_ORIGINS="http://localhost:3000,https://votre-domaine.com"

# ========== ALERTES EMAIL (OBLIGATOIRE) ==========
EMAIL_USER=votre-email@gmail.com
EMAIL_PASS=votre-mot-de-passe-app
EMAIL_SERVICE=gmail

# ========== LOGS & MONITORING ==========
LOG_LEVEL=info
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
```

### 4. Configuration Gmail pour les Alertes

Pour activer les alertes email avec Gmail :

1. **Activez l'authentification √† 2 facteurs** sur votre compte Google
2. **G√©n√©rez un mot de passe d'application** :
   - Allez sur [Google Account Security](https://myaccount.google.com/security)
   - S√©curit√© ‚Üí Authentification √† 2 facteurs ‚Üí Mots de passe des applications
   - S√©lectionnez "Autre" et nommez-le "AmaCompare"
   - **Utilisez ce mot de passe g√©n√©r√©** dans `EMAIL_PASS`

### 5. Installation Frontend
```bash
cd ../frontend
npm install
```

### 6. D√©marrage

**Backend (Terminal 1):**
```bash
cd backend
npm run dev
# Serveur d√©marr√© sur http://localhost:5000
```

**Frontend (Terminal 2):**
```bash
cd frontend
npm start
# Interface d√©marr√©e sur http://localhost:3000
```

## üìñ Guide d'Utilisation

### 1. Recherche de Produits
1. Saisissez le nom d'un produit (ex: "iPhone 15", "MacBook Pro")
2. Cliquez sur "üîç Rechercher"
3. Parcourez les r√©sultats avec images, prix et √©valuations

### 2. Comparaison des Prix
1. Cliquez sur un produit dans les r√©sultats
2. L'application compare automatiquement les prix sur 4 sites Amazon
3. Le meilleur prix est mis en √©vidence avec les √©conomies possibles

### 3. Historique des Prix
- L'historique se construit automatiquement √† chaque comparaison
- Visualisez les tendances avec les graphiques interactifs
- Changez la p√©riode d'affichage (7 jours √† 6 mois)

### 4. Cr√©er une Alerte Prix
1. Apr√®s une comparaison, cliquez sur "üîî Cr√©er une alerte prix"
2. Choisissez le pays et d√©finissez votre prix cible
3. Saisissez votre email de notification
4. Recevez un email d√®s que le prix baisse sous votre seuil !

## üîß API Documentation

### Endpoints Principaux

#### `POST /api/search`
Recherche de produits sur Amazon.fr
```javascript
// Request
{
  "query": "iPhone 15"
}

// Response
{
  "query": "iPhone 15",
  "products": [
    {
      "id": 1,
      "title": "Apple iPhone 15 (128 Go) - Noir",
      "price": 969,
      "image": "https://...",
      "asin": "B0CHX2F5QT",
      "rating": "4.5",
      "reviewsCount": "(1,234)"
    }
  ],
  "count": 20
}
```

#### `POST /api/compare/:asin`
Comparaison des prix europ√©ens
```javascript
// Response
{
  "asin": "B0CHX2F5QT",
  "productName": "Apple iPhone 15 (128 Go) - Noir",
  "countries": [
    {
      "country": "FR",
      "countryName": "France",
      "flag": "üá´üá∑",
      "price": 969,
      "currency": "‚Ç¨",
      "bestPrice": true,
      "savings": 0,
      "availability": "En stock",
      "url": "https://amazon.fr/dp/B0CHX2F5QT"
    }
  ],
  "bestPrice": 969,
  "maxSavings": 50
}
```

#### `POST /api/alerts`
Cr√©ation d'une alerte prix
```javascript
// Request
{
  "asin": "B0CHX2F5QT",
  "targetPrice": 899,
  "email": "user@example.com",
  "country": "FR",
  "productName": "iPhone 15",
  "productImage": "https://..."
}
```

#### `GET /api/price-history/:asin?days=30`
Historique des prix
```javascript
// Response
{
  "asin": "B0CHX2F5QT",
  "history": {
    "FR": [
      { "price": 969, "date": "2025-01-10", "availability": "En stock" }
    ]
  },
  "stats": {
    "FR": {
      "minPrice": 950,
      "maxPrice": 1000,
      "avgPrice": 975,
      "currentPrice": 969,
      "trend": "down"
    }
  }
}
```

## üöÄ D√©ploiement

### D√©ploiement sur Railway
1. Connectez votre d√©p√¥t GitHub √† [Railway](https://railway.app)
2. Configurez les variables d'environnement dans le dashboard
3. Le d√©ploiement est automatique !

### D√©ploiement sur Vercel (Frontend)
```bash
cd frontend
npm run build
npx vercel --prod
```

### D√©ploiement Docker
```dockerfile
# Dockerfile
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm install --only=production
COPY . .
EXPOSE 5000
CMD ["npm", "start"]
```

## üõ†Ô∏è D√©veloppement

### Scripts Disponibles

**Backend:**
```bash
npm run dev          # D√©veloppement avec nodemon
npm start           # Production
npm run test        # Tests (√† impl√©menter)
```

**Frontend:**
```bash
npm start           # Serveur de d√©veloppement
npm run build       # Build de production
npm test            # Tests React
```

### Structure de la Base de Donn√©es

```sql
-- Table historique des prix
CREATE TABLE price_history (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    asin TEXT NOT NULL,
    country TEXT NOT NULL,
    price REAL NOT NULL,
    timestamp DATETIME DEFAULT CURRENT_TIMESTAMP,
    title TEXT,
    image_url TEXT,
    availability TEXT,
    url TEXT
);

-- Table alertes prix
CREATE TABLE price_alerts (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    asin TEXT NOT NULL,
    target_price REAL NOT NULL,
    email TEXT NOT NULL,
    country TEXT NOT NULL,
    product_name TEXT,
    product_image TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    is_active BOOLEAN DEFAULT 1,
    triggered_at DATETIME NULL
);
```

## ‚ö†Ô∏è Troubleshooting

### Probl√®mes Courants

**1. Erreur Puppeteer "Chrome not found"**
```bash
# Solution 1: Installer Chromium
sudo apt-get install chromium-browser

# Solution 2: Sp√©cifier le chemin
export PUPPETEER_EXECUTABLE_PATH=/usr/bin/chromium-browser
```

**2. Alertes email ne fonctionnent pas**
- V√©rifiez que `EMAIL_USER` et `EMAIL_PASS` sont corrects
- Assurez-vous d'utiliser un mot de passe d'application Gmail
- Testez avec l'endpoint `/api/test-email` (en d√©veloppement)

**3. Base de donn√©es locked**
```bash
# Red√©marrer le serveur r√©sout g√©n√©ralement le probl√®me
npm run dev
```

**4. Scraping bloqu√© par Amazon**
- Les requ√™tes sont limit√©es pour √©viter les blocages
- Le cache r√©duit les appels r√©p√©t√©s
- Rotation des User-Agents impl√©ment√©e

### Mode Debug
```env
LOG_LEVEL=debug
NODE_ENV=development
```

### Endpoints de Test
- `GET /api/health` - √âtat du serveur
- `GET /api/test-search/:query` - Test recherche
- `GET /api/test-compare/:asin` - Test comparaison
- `POST /api/test-email` - Test envoi email (dev only)

## üìä Monitoring & Analytics

Le serveur fournit des m√©triques utiles :
- Cache hit/miss ratio
- Temps de r√©ponse des requ√™tes
- Taux d'erreur par pays Amazon
- Nombre d'alertes actives

Acc√©dez aux statistiques via `GET /api/health`

## ü§ù Contribution

1. **Fork** le projet
2. Cr√©ez votre branche feature (`git checkout -b feature/AmazingFeature`)
3. Committez vos changements (`git commit -m 'Add AmazingFeature'`)
4. Push vers la branche (`git push origin feature/AmazingFeature`)
5. Ouvrez une **Pull Request**

### Standards de Code
- ESLint pour JavaScript
- Prettier pour le formatage
- Commentaires JSDoc pour les fonctions complexes

## üìù Licence

Ce projet est sous licence MIT. Voir le fichier `LICENSE` pour plus de d√©tails.

## üîÆ Roadmap

### Version 2.0 (Prochaine)
- [ ] üåç Support d'autres pays (UK, Canada)
- [ ] üì± Application mobile React Native
- [ ] ü§ñ API REST publique avec authentification
- [ ] üìà Pr√©dictions de prix avec ML
- [ ] üíæ Export des donn√©es en CSV/Excel
- [ ] üîó Int√©gration webhook Discord/Slack

### Version 2.1
- [ ] üõ°Ô∏è Authentification utilisateur
- [ ] üìä Dashboard analytics avanc√©
- [ ] üéØ Alertes conditionnelles (stock, promotions)
- [ ] üîÑ Synchronisation cloud
- [ ] üåê Interface multilingue

## üë®‚Äçüíª √âquipe

**D√©veloppeur Principal:** [Votre Nom]
- üêô GitHub: [@votre-username](https://github.com/votre-username)
- üìß Email: votre.email@example.com

## üôè Remerciements

- **Puppeteer** pour le web scraping robuste
- **Recharts** pour les graphiques magnifiques
- **Amazon** pour... √™tre Amazon üòÑ
- **Communaut√© Open Source** pour l'inspiration

---

<div align="center">

**‚≠ê Si ce projet vous aide, n'h√©sitez pas √† lui donner une √©toile ! ‚≠ê**

Made with ‚ù§Ô∏è and ‚òï in France üá´üá∑

[üêõ Reporter un Bug](https://github.com/votre-repo/amacompare/issues) ‚Ä¢ [üí° Sugg√©rer une Feature](https://github.com/votre-repo/amacompare/issues) ‚Ä¢ [üìñ Documentation](https://github.com/votre-repo/amacompare/wiki)

</div>